# influx_gateway
Приложение забирает данные из удаленной БД и переклдаывает их в локальную БД.

## Общее описание

Приложение при запуске принимает имя конфиг файла как параметр, читает свою конфигурацию. В конфигурации долнжны быть описаны параметры подключения к локальной и удаленной БД, а также параметры метрик которые будут синхронизироваться между БД.

При каждом запуске приложение проверяет подключение к локальной и удалнной БД, а также наличие в БД запрашиваемых метрик.
В случае если в локльной СУБД нет нужной БД, она создается автоматически, в случае отстуствия метрик ония будут созадны при первой записи данных.
Если не доступна удаленная БД, приложение пишет сообщение в лог и заврешает работу.
 
Если БД доступны, приложение проверяет, в локальной БД, последние данные для каждой из метрик, описанных в конфигурационном файле, если данных в локальной БД нет то выгружаются все доступные данные по данной метрике из удаленной БД, собираются в пакет данных  и зургажаются в локальную БД.

## Конфигурация 

Конфигурация приложения описыватес я json файле, формат файла:

    {
      "site_name": "akom",
      "allow_create_local_db": "yes",
    
site_name - унакальное название, по нему генерируется лог файла

allow_create_local_db - разрешать ли создание локальной БД


      "remote_influx": {
        "dbname": "telegraf",
        "dbhost": "10.10.12.169",
        "dbport": "8086",
        "dbuser": "telegraf",
        "dbpass": "metricsmetricsmetricsmetrics"
      },
      
параметры подключения в уделенную БД      
     
      "local_influx": {
        "dbname": "telegraf",
        "dbhost": "10.200.12.169",
        "dbport": "8090",
        "dbuser": "telegraf",
        "dbpass": "metricsmetricsmetricsmetrics"
      },

параметры подключения в локальную БД

      "metrics": {
        "cpu": {
          "usage system and guest pre host and cpu": {
            "tags": [
              "host",
              "cpu"
            ],
            "values": [
              "usage_system",
              "usage_guest",
              "usage_idle"
            ]
            }
        },
        "disk": {
          "value 1, value 2 per host and device": {
            "tags": [
              "host",
              "device",
              "fstype",
              "mode",
              "path"
            ],
            "values": [
              "free",
              "total",
              "used"
            ]
          }
        }
      }
    }
    
описание метрик